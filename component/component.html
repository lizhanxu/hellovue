<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>《Vue.js实战》-6 组件</title>
    </head>
    <body>
        <div id="app-1">
            <my-component-1></my-component-1>
        </div>
        <br>

        <div id="app-2">
            <my-component-2></my-component-2>
        </div>
        <br>

        <div id="app-3">
            <table>
                <my-component-3></my-component-3>
                <!-- 元素限制，table内只允许<tr><th><td>等表格元素，可以通过is属性来挂载组件 -->
                <tbody is="my-component-3"></tbody>
            </table>
            <!-- 不使用is的渲染结果，没有table
            <div>这里是组件的内容</div> -->

            <!-- 使用is的渲染结果
            <table>
                <div>这里是组件的内容</div>
            </table> -->
        </div>
        <br>

        <div id="app-4">
            <my-button-1></my-button-1>
            <my-button-1></my-button-1>
            <my-button-1></my-button-1>
        </div>
        <br>

        <div id="app-5">
            <my-button-2></my-button-2>
            <my-button-2></my-button-2>
            <my-button-2></my-button-2>
        </div>
        <br>

        <!-- 组件通信 -->
        <div id="app-6">
            <my-component-4 packet="来自父组件的数据"></my-component-4>
        </div>
        <br>

        <!-- 动态绑定props的值 -->
        <div id="app-7">
            <!-- v-model静态绑定parentMessage -->
            <input type="text" v-model="parentMessage">
            <!-- message与parentMessage动态双向绑定 -->
            <my-component-5 :message="parentMessage"></my-component-5>
        </div>
        <br>

        <!-- 子组件作用域内修改 -->
        <div id="app-8">
            <my-component-6 :initcount="1"></my-component-6>
        </div>
    </body>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script>
        // 全局注册组件，全局注册后任何Vue实例都可以使用
        Vue.component('my-component-1',{
            template:'<div>这里是组件的内容</div>'
        });
        var app1 = new Vue({
            el:'#app-1'
        })

        //局部注册组件，通过Vue实例的components
        var Child = {
            template:'<div>局部注册组件的内容</div>'
        };
        var app2 = new Vue({
            el:'#app-2',
            components:{
                'my-component-2':Child
            }
        });

        // 元素限制
        Vue.component('my-component-3',{
            template:'<div>这里是组件的内容</div>'
        });
        var app3 = new Vue({
            el:'#app-3'
        });


        // 共享对象
        var value={
            counter:0
        };
        Vue.component('my-button-1',{
            template:'<button @click="counter++">{{counter}}</button>',
            data:function(){
                return value;
            }
        });
        var app4 = new Vue({
            el:'#app-4'
        });

        // 给每个组件返回一个独立的对象
        Vue.component('my-button-2',{
            template:'<button @click="counter++">{{counter}}</button>',
            data:function(){
                return {
                    counter:0
                };
            }
        });
        var app5 = new Vue({
            el:'#app-5'
        });

        // 组件通信
        Vue.component('my-component-4',{
            props:['packet'],
            template:'<div>{{packet}}</div>'
        });
        var app6 = new Vue({
            el:'#app-6'
        });

        // 动态绑定props的值
        Vue.component('my-component-5',{
            props:['message'],
            template:'<div>{{message}}</div>'
        });
        var app7 = new Vue({
            el:'#app-7',
            data:{
                parentMessage:''
            }
        });

        // 父组件传递初始值，子组件将它保存下来，在自己的作用域内随便修改
        // 在子组件的data中声明一个数据，引用父组件的prop
        // initcount不能用init-count,加上'-'不认识
        Vue.component('my-component-6',{
            props:['initcount'],
            template:'<div>{{count}}</div>',
            data:function(){
                return {
                    count:this.initcount
                };
            }
        });
        var app8 = new Vue({
            el:'#app-8'
        });

        // 数据验证
        Vue.component('my-component',{
            props:{
                // 必须是Number类型
                propA: Number,
                // 必须是String或Number类型
                propB: [String,Number],
                // 必须是布尔值，默认为true
                propC: {
                    type:Boolean,
                    default:true
                },
                // 数字类型，必传
                propD: {
                    type:Number,
                    required:true
                },
                propE:{
                    type:Array,
                    default:function(){
                        return [];
                    }
                },
                // 自定义一个验证函数
                propF:{
                    validator:function(value){
                        return value>10;
                    }
                }
            }
        })
    </script>
</html>